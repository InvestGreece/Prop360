<Activity mc:Ignorable="sap sap2010" x:Class="AlertPassportExpiration" VisualBasic.Settings="{x:Null}" sap2010:WorkflowViewState.IdRef="AlertPassportExpiration_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:uga="clr-namespace:UiPath.GSuite.Activities;assembly=UiPath.GSuite.Activities" xmlns:ugage="clr-namespace:UiPath.GSuite.Activities.Gmail.Enums;assembly=UiPath.GSuite.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:upr="clr-namespace:UiPath.Platform.ResourceHandling;assembly=UiPath.Platform" xmlns:usau="clr-namespace:UiPath.Shared.Activities.Utils;assembly=UiPath.GSuite.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>UiPath.UIAutomationCore.Contracts</x:String>
      <x:String>UiPath.Platform.SyncObjects</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>UiPath.Web</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Web.Activities</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>System.Numerics</x:String>
      <x:String>System.Runtime.CompilerServices</x:String>
      <x:String>UiPath.Activities.System.Orchestrator.Mail</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail.Enums</x:String>
      <x:String>UiPath.Shared.Activities.Utils</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.Activities.Enums</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.GSuite.Activities.Gmail.Enums</x:String>
      <x:String>UiPath.GSuite.Activities</x:String>
      <x:String>UiPath.Shared.Activities.ConnectionService.Contracts</x:String>
      <x:String>UiPath.Vision.MicrosoftAzure.Models.ReadApiV3</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>System.Activities.Runtime.Collections</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Drawing.Common</AssemblyReference>
      <AssemblyReference>System.Drawing.Primitives</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Net.Mail</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>System.Linq.Expressions</AssemblyReference>
      <AssemblyReference>System.ComponentModel.EventBasedAsync</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.Collections.Specialized</AssemblyReference>
      <AssemblyReference>System.Collections.NonGeneric</AssemblyReference>
      <AssemblyReference>UiPath.Web</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.Runtime.InteropServices</AssemblyReference>
      <AssemblyReference>UiPath.Web.Activities</AssemblyReference>
      <AssemblyReference>System.Reflection.DispatchProxy</AssemblyReference>
      <AssemblyReference>System.Reflection.TypeExtensions</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>NPOI.Core</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Runtime.Numerics</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Linq.Parallel</AssemblyReference>
      <AssemblyReference>System.Linq.Queryable</AssemblyReference>
      <AssemblyReference>System.Runtime.CompilerServices.VisualC</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.Linq.Async</AssemblyReference>
      <AssemblyReference>UiPath.GSuite.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Vision.AzureComputerVision</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Core</AssemblyReference>
      <AssemblyReference>System.Text.RegularExpressions</AssemblyReference>
      <AssemblyReference>System.Linq.Async.Queryable</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.Private.Xml</AssemblyReference>
      <AssemblyReference>System.Data.SqlClient</AssemblyReference>
      <AssemblyReference>Microsoft.Extensions.DependencyModel</AssemblyReference>
      <AssemblyReference>System.CodeDom</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Forms</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Core</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="AlertPassportExpiration" sap:VirtualizedContainerService.HintSize="892,5964" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:Int32" Name="alertDays" />
      <Variable x:TypeArguments="x:String" Name="formId" />
      <Variable x:TypeArguments="x:String" Name="auth_token" />
      <Variable x:TypeArguments="x:Int32" Name="page" />
      <Variable x:TypeArguments="x:String" Name="limit" />
      <Variable x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))" Name="allIds" />
      <Variable x:TypeArguments="x:String" Name="requestHeaders" />
      <Variable x:TypeArguments="ui:Browser" Name="uibrowser" />
      <Variable x:TypeArguments="x:Int32" Name="alertDaysLowerBound" />
      <Variable x:TypeArguments="x:Int32" Name="index">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:String x:Key="SourceIdRef">InterruptibleDoWhile_1</x:String>
            <x:String x:Key="SourcePropertyName">CurrentIndex</x:String>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </Variable>
      <Variable x:TypeArguments="sd:DataTable" Name="dtSentEmails" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="642,148" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
      <ui:MultipleAssign.AssignOperations>
        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:Int32">[alertDays]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:Int32">90</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
        </scg:List>
      </ui:MultipleAssign.AssignOperations>
    </ui:MultipleAssign>
    <ui:OpenBrowser AutomaticallyDownloadWebDriver="{x:Null}" CommunicationMethod="{x:Null}" Hidden="{x:Null}" NewSession="{x:Null}" Private="{x:Null}" BrowserType="Chrome" DisplayName="Open Browser" sap:VirtualizedContainerService.HintSize="642,1966" sap2010:WorkflowViewState.IdRef="OpenBrowser_1" UiBrowser="[uibrowser]" Url="https://prop360.pro/dashboard/forms/contacts">
      <ui:OpenBrowser.Body>
        <ActivityAction x:TypeArguments="x:Object">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="484,1809" sap2010:WorkflowViewState.IdRef="Sequence_4">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" TimeoutMS="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe  Prop360°'" sap:VirtualizedContainerService.HintSize="450,1749" sap2010:WorkflowViewState.IdRef="BrowserScope_1" InformativeScreenshot="4ff1af9c176c05095f0168e096be112c" Selector="&lt;html app='chrome.exe' title='Prop360°' /&gt;">
              <ui:BrowserScope.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="416,1539" sap2010:WorkflowViewState.IdRef="Sequence_3">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:SendHotkey ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SpecialKey="{x:Null}" Activate="True" DisplayName="Send Hotkey 'H2'" sap:VirtualizedContainerService.HintSize="382,185" sap2010:WorkflowViewState.IdRef="SendHotkey_1" Key="c" KeyModifiers="Ctrl, Shift">
                      <ui:SendHotkey.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="000b26fb-6bb0-461b-8223-b53ad92abe93" InformativeScreenshot="b0f093211eaa8020506c8c50f4266c2c" Selector="&lt;webctrl tag='H2' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SendHotkey.Target>
                    </ui:SendHotkey>
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'page tab  Network'" sap:VirtualizedContainerService.HintSize="382,139" sap2010:WorkflowViewState.IdRef="Click_1" KeyModifiers="None" MouseButton="BTN_LEFT">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="ce560cac-3f0e-496a-ad8f-cc25429f6719" InformativeScreenshot="8ac103cfe90e413d678b923f79e1e02b" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='Prop360° - Google Chrome' /&gt;&lt;ctrl name='DevTools' role='document' /&gt;&lt;ctrl name='Main toolbar' role='grouping' /&gt;&lt;ctrl name='Panels' role='page tab list' /&gt;&lt;ctrl name='Network' role='page tab' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:SendHotkey ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SpecialKey="{x:Null}" Activate="True" DisplayName="Send Hotkey 'page tab  Network'" sap:VirtualizedContainerService.HintSize="382,185" sap2010:WorkflowViewState.IdRef="SendHotkey_2" Key="r" KeyModifiers="Ctrl">
                      <ui:SendHotkey.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="4c92183d-9462-4adf-86ac-044b576131d1" InformativeScreenshot="20cf37f8845fafdc61111ac56316984f" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='Prop360° - Google Chrome' /&gt;&lt;ctrl name='DevTools' role='document' /&gt;&lt;ctrl name='Main toolbar' role='grouping' /&gt;&lt;ctrl name='Panels' role='page tab list' /&gt;&lt;ctrl name='Network' role='page tab' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SendHotkey.Target>
                    </ui:SendHotkey>
                    <Delay Duration="00:00:05" sap:VirtualizedContainerService.HintSize="382,122" sap2010:WorkflowViewState.IdRef="Delay_1" />
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'push button  Clear'" sap:VirtualizedContainerService.HintSize="382,139" sap2010:WorkflowViewState.IdRef="Click_2" KeyModifiers="None" MouseButton="BTN_LEFT">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="f1ce0998-69f5-404f-a911-86307d9728b2" InformativeScreenshot="ced994336184d2b577f91d59f4a4736c" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='Prop360° - Google Chrome' /&gt;&lt;ctrl name='DevTools' role='document' /&gt;&lt;ctrl name='Network panel' role='property page' /&gt;&lt;ctrl name='network' role='grouping' /&gt;&lt;ctrl name='Clear' role='grouping' /&gt;&lt;ctrl name='Clear' role='push button' /&gt;" TimeoutMS="5000">
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:TypeInto AlterIfDisabled="{x:Null}" ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SimulateType="{x:Null}" Activate="True" DisplayName="Type Into 'editable text'" sap:VirtualizedContainerService.HintSize="382,187" sap2010:WorkflowViewState.IdRef="TypeInto_1" Text="form_data?indicator=contacts">
                      <ui:TypeInto.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="04535895-3313-44cc-872e-082febc475ff" InformativeScreenshot="3de35167cb4516eeb0b33b36fc65800f" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='Prop360° - Google Chrome' /&gt;&lt;ctrl name='DevTools' role='document' /&gt;&lt;ctrl name='Network panel' role='property page' /&gt;&lt;ctrl name='network' role='grouping' /&gt;&lt;ctrl idx='4' role='editable text' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:TypeInto.Target>
                    </ui:TypeInto>
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'cell '" sap:VirtualizedContainerService.HintSize="382,139" sap2010:WorkflowViewState.IdRef="Click_3" KeyModifiers="None" MouseButton="BTN_RIGHT">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="acc7611e-cd5a-4004-87ee-f50b436ef381" InformativeScreenshot="75d3bb7e560bdb1edb154b4aad436f17" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='Prop360° - Google Chrome' /&gt;&lt;ctrl name='DevTools' role='document' /&gt;&lt;ctrl name='Network panel' role='property page' /&gt;&lt;ctrl name='network' role='grouping' /&gt;&lt;ctrl role='row' /&gt;&lt;ctrl name='form_data?indicator=contacts&amp;amp;page=1&amp;amp;limit=10&amp;amp;sortF…&amp;amp;formId=67d15*' role='cell' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'menu item  Copy'" sap:VirtualizedContainerService.HintSize="382,139" sap2010:WorkflowViewState.IdRef="Click_4" KeyModifiers="None" MouseButton="BTN_LEFT">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d8ca61e2-7ec1-4b35-88db-1f9a9bf1aa10" InformativeScreenshot="9f08ba7ddc8d83e1506b8a9cdded66b9" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' idx='*' /&gt;&lt;ctrl name='Copy' role='menu item' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'menu item'" sap:VirtualizedContainerService.HintSize="382,139" sap2010:WorkflowViewState.IdRef="Click_5" KeyModifiers="None" MouseButton="BTN_LEFT">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="9456b28b-eaee-48f8-8b2f-b31c6b92396e" InformativeScreenshot="9348cb07ca8793d5d7351f5cbc677cb0" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' idx='*' /&gt;&lt;ctrl name='Copy' role='menu bar' /&gt;&lt;ctrl name='Copy' role='popup menu' /&gt;&lt;ctrl name='Copy request headers' role='menu item' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <ui:GetFromClipboard TimeoutMS="{x:Null}" DisplayName="Get From Clipboard" sap:VirtualizedContainerService.HintSize="382,57" sap2010:WorkflowViewState.IdRef="GetFromClipboard_1">
                      <ui:GetFromClipboard.Result>
                        <OutArgument x:TypeArguments="x:String">[requestHeaders]</OutArgument>
                      </ui:GetFromClipboard.Result>
                    </ui:GetFromClipboard>
                    <ui:CloseTab Browser="{x:Null}" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="382,48" sap2010:WorkflowViewState.IdRef="CloseTab_1" />
                  </Sequence>
                </ActivityAction>
              </ui:BrowserScope.Body>
            </ui:BrowserScope>
          </Sequence>
        </ActivityAction>
      </ui:OpenBrowser.Body>
    </ui:OpenBrowser>
    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="642,272" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
      <ui:MultipleAssign.AssignOperations>
        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[formId]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Match(requestHeaders, "formId=([^&amp;\s]+)").Groups(1).Value]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap:VirtualizedContainerService.HintSize="334.4,24.799999999999997" sap2010:WorkflowViewState.IdRef="AssignOperation_2">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[auth_token]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Match(requestHeaders, "Authorization:\s*Bearer\s+([^\r\n]+)").Groups(1).Value]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:Int32">[page]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:Int32">0</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[limit]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">1000</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[allIds]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[New List(Of Tuple(Of String, String, String))]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
        </scg:List>
      </ui:MultipleAssign.AssignOperations>
    </ui:MultipleAssign>
    <Sequence DisplayName="Get contacts (1)" sap:VirtualizedContainerService.HintSize="642,1252" sap2010:WorkflowViewState.IdRef="Sequence_2">
      <Sequence.Variables>
        <Variable x:TypeArguments="x:Int32" Name="totalPages" />
      </Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:InterruptibleDoWhile CurrentIndex="[index]" DisplayName="Do While" sap:VirtualizedContainerService.HintSize="547,1160" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_1">
        <ui:InterruptibleDoWhile.Body>
          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="513,1023" sap2010:WorkflowViewState.IdRef="Sequence_5">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:String" Name="response_content" />
              <Variable x:TypeArguments="x:Int32" Name="response_status" />
              <Variable x:TypeArguments="njl:JObject" Name="jsonResponseObj" />
              <Variable x:TypeArguments="njl:JArray" Name="formData" />
              <Variable x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))" Name="idList" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Assign sap:VirtualizedContainerService.HintSize="479,114" sap2010:WorkflowViewState.IdRef="Assign_2">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[page]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">[page + 1]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" ContinueOnError="{x:Null}" FileAttachments="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseAttachment="{x:Null}" ResponseHeaders="{x:Null}" SecureClientCertificatePassword="{x:Null}" SecurePassword="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" AuthenticationType="None" BodyFormat="application/xml" DisplayName="HTTP Request" EnableSSLVerification="True" EndPoint="https://prop360.pro/api/merchant/form_data" sap:VirtualizedContainerService.HintSize="479,102" sap2010:WorkflowViewState.IdRef="HttpClient_1" Method="GET" Result="[response_content]" StatusCode="[response_status]" TimeoutMS="6000">
              <ui:HttpClient.Attachments>
                <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
              </ui:HttpClient.Attachments>
              <ui:HttpClient.Cookies>
                <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
              </ui:HttpClient.Cookies>
              <ui:HttpClient.Headers>
                <InArgument x:TypeArguments="x:String" x:Key="Authorization">["Bearer " + auth_token]</InArgument>
              </ui:HttpClient.Headers>
              <ui:HttpClient.Parameters>
                <InArgument x:TypeArguments="x:String" x:Key="indicator">contacts</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="page">[page.ToString]</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="limit">[limit]</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="sortField">metadata.createdAt</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="sortOrder">desc</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="isNumeric">false</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="formId">[formId]</InArgument>
              </ui:HttpClient.Parameters>
              <ui:HttpClient.UrlSegments>
                <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
              </ui:HttpClient.UrlSegments>
            </ui:HttpClient>
            <ui:DeserializeJson x:TypeArguments="njl:JObject" JsonSample="{x:Null}" DisplayName="Deserialize JSON" sap:VirtualizedContainerService.HintSize="479,122" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_1" JsonObject="[jsonResponseObj]" JsonString="[response_content]" />
            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="479,173" sap2010:WorkflowViewState.IdRef="LogMessage_2" Message="[&quot;Retreived contact records for page: &quot; + page.ToString() + &quot; , when total pages: &quot; + totalPages.ToString()]" />
            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="479,179" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="njl:JArray">[formData]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="njl:JArray">[CType(jsonResponseObj("data"), Newtonsoft.Json.Linq.JArray)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap:VirtualizedContainerService.HintSize="334.4,24.799999999999997" sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[idList]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[formData.Where(Function(x) CType(x, Newtonsoft.Json.Linq.JObject).ContainsKey("data") AndAlso CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject).ContainsKey("field-1741774547654-ngd30kdcz") AndAlso CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject).ContainsKey("field-1741774690043-v7jylsjj2") AndAlso CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject).ContainsKey("field-1741779403411-cgccurwgk") AndAlso DateTime.TryParse(CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject)("field-1741779403411-cgccurwgk").ToString(), New Date()) AndAlso (DateTime.Parse(CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject)("field-1741779403411-cgccurwgk").ToString()) - DateTime.UtcNow).TotalDays &lt;= alertDays).Select(Function(x) Tuple.Create(CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject)("field-1741774547654-ngd30kdcz").ToString(), CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject)("field-1741774690043-v7jylsjj2").ToString(), CType(CType(x, Newtonsoft.Json.Linq.JObject)("data"), Newtonsoft.Json.Linq.JObject)("field-1741779403411-cgccurwgk").ToString())).ToList()]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="479,168" sap2010:WorkflowViewState.IdRef="InvokeMethod_1" MethodName="AddRange">
              <InvokeMethod.TargetObject>
                <InArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[allIds]</InArgument>
              </InvokeMethod.TargetObject>
              <InArgument x:TypeArguments="scg:List(s:Tuple(x:String, x:String, x:String))">[idList]</InArgument>
            </InvokeMethod>
            <Assign sap:VirtualizedContainerService.HintSize="479,105" sap2010:WorkflowViewState.IdRef="Assign_3">
              <Assign.To>
                <OutArgument x:TypeArguments="x:Int32">[totalPages]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:Int32">[CInt(jsonResponseObj("pagination")("totalPages"))]</InArgument>
              </Assign.Value>
            </Assign>
          </Sequence>
        </ui:InterruptibleDoWhile.Body>
        <ui:InterruptibleDoWhile.Condition>
          <VisualBasicValue x:TypeArguments="x:Boolean" ExpressionText="page &lt;= totalPages" sap2010:WorkflowViewState.IdRef="VisualBasicValue`1_1" />
        </ui:InterruptibleDoWhile.Condition>
      </ui:InterruptibleDoWhile>
    </Sequence>
    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="642,2303" sap2010:WorkflowViewState.IdRef="Sequence_10">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:ReadRange Range="{x:Null}" WorkbookPathResource="{x:Null}" AddHeaders="True" DataTable="[dtSentEmails]" DisplayName="Read Range Workbook" sap:VirtualizedContainerService.HintSize="608,120" sap2010:WorkflowViewState.IdRef="ReadRange_1" SheetName="Sheet1" WorkbookPath="PassportExpSentEmails.xlsx" />
      <Sequence DisplayName="Send Email" sap:VirtualizedContainerService.HintSize="608,2100" sap2010:WorkflowViewState.IdRef="Sequence_6">
        <Sequence.Variables>
          <Variable x:TypeArguments="x:Int32" Name="idx" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:ForEach x:TypeArguments="s:Tuple(x:String, x:String, x:String)" CurrentIndex="[idx]" DisplayName="For Each currentContact" sap:VirtualizedContainerService.HintSize="574,2017" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[allIds]">
          <ui:ForEach.Body>
            <ActivityAction x:TypeArguments="s:Tuple(x:String, x:String, x:String)">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="s:Tuple(x:String, x:String, x:String)" Name="currentContact" />
              </ActivityAction.Argument>
              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="540,1880" sap2010:WorkflowViewState.IdRef="Sequence_9">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:Int32" Name="share_response_status" />
                  <Variable x:TypeArguments="x:String" Name="share_response_content" />
                  <Variable x:TypeArguments="njl:JObject" Name="sharedJsonContent" />
                  <Variable x:TypeArguments="njl:JToken" Name="match" />
                  <Variable x:TypeArguments="x:String" Name="merchantId" />
                  <Variable x:TypeArguments="x:String" Name="recipientEmail" />
                  <Variable x:TypeArguments="x:String" Name="recipientName" />
                  <Variable x:TypeArguments="x:String" Name="recipientExpiry" />
                  <Variable x:TypeArguments="x:Boolean" Name="isEmailAlreadySent" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="506,210" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[recipientName]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[allIds(idx).Item1]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[recipientEmail]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[allIds(idx).Item2]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[recipientExpiry]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[allIds(idx).Item3]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <Assign sap:VirtualizedContainerService.HintSize="506,114" sap2010:WorkflowViewState.IdRef="Assign_4">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Boolean">[isEmailAlreadySent]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Boolean">[dtSentEmails.AsEnumerable().Any(Function(r) r("Email").ToString() = recipientEmail)]</InArgument>
                  </Assign.Value>
                </Assign>
                <If Condition="[isEmailAlreadySent]" sap:VirtualizedContainerService.HintSize="506,1496" sap2010:WorkflowViewState.IdRef="If_1">
                  <If.Then>
                    <Sequence DisplayName="Then" sap:VirtualizedContainerService.HintSize="416,108" sap2010:WorkflowViewState.IdRef="Sequence_11">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:Continue sap:VirtualizedContainerService.HintSize="382,48" sap2010:WorkflowViewState.IdRef="Continue_1" />
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <Sequence DisplayName="Else" sap:VirtualizedContainerService.HintSize="472,1227" sap2010:WorkflowViewState.IdRef="Sequence_12">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438,637" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                        <TryCatch.Try>
                          <uga:SendEmailConnections ArgumentAttachmentPaths="{x:Null}" ArgumentAttachments="{x:Null}" AttachmentPaths="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" ConnectionAccountName="{x:Null}" ContinueOnError="{x:Null}" ReplyTo="{x:Null}" SingleAttachment="{x:Null}" TextBody="{x:Null}" AttachmentInputMode="UseExisting" AuthScopesInvalid="False" Body="[&quot;&lt;!doctype html&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;html&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;head&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;meta charset='utf-8'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;meta name='viewport' content='width=device-width,initial-scale=1'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;style&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; padding:0; background:#f4f6f8; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .container { max-width:600px; margin:24px auto; background:#ffffff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.06); }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .header { background:#0b74de; color:#ffffff; padding:18px 24px; text-align:left; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .header h1 { margin:0; font-size:20px; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .content { padding:20px 24px; color:#333333; font-size:14px; line-height:1.5; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .details { margin-top:12px; padding:12px; background:#f7fafc; border-radius:6px; font-size:13px; color:#444; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .footer { font-size:12px; color:#888; padding:14px 24px; text-align:center; background:#fbfcfd; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    .muted { color:#6b7280; }&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;/style&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;/head&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;body&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;div class='container'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;div class='header'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;h1&gt;Pasaportunuzun Tarihini Kontrol Etmeniz Gerekiyor &lt;/h1&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;/div&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;div class='content'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;p&gt;Dear &lt;strong&gt;&quot; &amp; recipientName &amp; &quot;&lt;/strong&gt;,&lt;/p&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;p&gt;Merhaba ben Kosta, size pasaportunuzun bitiş tarihine yaklaştığını veya tarihinin geçmiş olduğunu bildirmek istiyorum .  &lt;strong&gt; son kullanma tarihi  &quot; &amp; recipientExpiry &amp; &quot;&lt;/strong&gt;.&lt;/p&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;div class='details'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;        &lt;strong&gt;Pasaport Geçerlili Tarihi :&lt;/strong&gt;&lt;br /&gt;&quot; &amp; recipientExpiry &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;/div&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;p&gt; Eğer pasaportunuzun geçerli olduğu tarih geçti ise lütfen yenileme işlemlerini gerçekleştirin. Eğer değiştirdi iseniz lütfen scan edip ka@investgreece.gr adresine gönderin.&lt;/p&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      &lt;p class='muted' style='margin-top:14px;'&gt; Bizimle istediğiniz zaman elektronik posta yolu ile veya whatsapp üzerinden ulaşabilirsiniz.&lt;/p&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;/div&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;div class='footer'&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;      © Invest Greece ekibi olarak bize her zaman ulaşabilirsiniz.&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;    &lt;/div&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;  &lt;/div&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;/body&gt;&quot; &amp; vbCrLf &amp; _&#xD;&#xA;&quot;&lt;/html&gt;&quot;]" ConnectionId="514f6a20-71fa-49b3-b0e5-6851fa05733f" DisplayName="Send Email" sap:VirtualizedContainerService.HintSize="334,377" sap2010:WorkflowViewState.IdRef="SendEmailConnections_1" Importance="Normal" InputType="HTML" SaveAsDraft="False" Subject="Passport Expiration Alert" To="[New String() {recipientEmail}]" UseConnectionService="True">
                            <uga:SendEmailConnections.Attachments>
                              <InArgument x:TypeArguments="scg:IEnumerable(upr:IResource)" />
                            </uga:SendEmailConnections.Attachments>
                            <uga:SendEmailConnections.AttachmentsBackup>
                              <usau:BackupSlot x:TypeArguments="ugage:AttachmentInputMode" StoredValue="UseExisting">
                                <usau:BackupSlot.BackupValues>
                                  <scg:Dictionary x:TypeArguments="ugage:AttachmentInputMode, scg:List(x:Object)" />
                                </usau:BackupSlot.BackupValues>
                              </usau:BackupSlot>
                            </uga:SendEmailConnections.AttachmentsBackup>
                            <uga:SendEmailConnections.InputTypeBackup>
                              <usau:BackupSlot x:TypeArguments="ugage:BodyInputType" StoredValue="HTML">
                                <usau:BackupSlot.BackupValues>
                                  <scg:List x:TypeArguments="x:Object" x:Key="HTML" Capacity="1">
                                    <InArgument x:TypeArguments="x:String">[string.Format("&lt;P&gt;&lt;SPAN&gt;Hi,&lt;/SPAN&gt;&lt;/P&gt;&lt;P&gt;&lt;SPAN&gt;Your passport is expiring &lt;/SPAN&gt;&lt;SPAN&gt;soon&lt;/SPAN&gt;&lt;SPAN&gt;.&lt;/SPAN&gt;&lt;/P&gt;")]</InArgument>
                                  </scg:List>
                                  <scg:List x:TypeArguments="x:Object" x:Key="TEXT" Capacity="1">
                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">["
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset='utf-8'&gt;
  &lt;meta name='viewport' content='width=device-width,initial-scale=1'&gt;
  &lt;style&gt;
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; padding:0; background:#f4f6f8; }
    .container { max-width:600px; margin:24px auto; background:#ffffff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.06); }
    .header { background:#0b74de; color:#ffffff; padding:18px 24px; text-align:left; }
    .header h1 { margin:0; font-size:20px; }
    .content { padding:20px 24px; color:#333333; font-size:14px; line-height:1.5; }
    .cta { display:inline-block; margin-top:16px; padding:10px 16px; background:#0b74de; color:#fff; text-decoration:none; border-radius:6px; }
    .details { margin-top:12px; padding:12px; background:#f7fafc; border-radius:6px; font-size:13px; color:#444; }
    .footer { font-size:12px; color:#888; padding:14px 24px; text-align:center; background:#fbfcfd; }
    .muted { color:#6b7280; }
    @media (max-width:420px){ .container{ margin:12px } .header h1{ font-size:18px } }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class='container'&gt;
    &lt;div class='header'&gt;
      &lt;h1&gt;Passport Expiration Notice&lt;/h1&gt;
    &lt;/div&gt;

    &lt;div class='content'&gt;
      &lt;p&gt;Dear &lt;strong&gt;" + recipientName + "&lt;/strong&gt;,&lt;/p&gt;

      &lt;p&gt;We are writing to inform you that your passport &lt;strong&gt;expires on " + recipientExpiry + "&lt;/strong&gt;.&lt;/p&gt;

      &lt;div class='details'&gt;
        &lt;strong&gt;Passport expiry date:&lt;/strong&gt;&lt;br /&gt;
        " + recipientExpiry + "
      &lt;/div&gt;

      &lt;p&gt;If your passport is already expired, please renew it as soon as possible to avoid service interruptions. If it is expiring soon, you may want to begin renewal procedures now.&lt;/p&gt;

      &lt;p class='muted' style='margin-top:14px;'&gt;If you believe you received this message in error, please contact our support team.&lt;/p&gt;
    &lt;/div&gt;

    &lt;div class='footer'&gt;
      © Invest Greece — For assistance, reply to this email or visit our support page.
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;"]</InArgument>
                                  </scg:List>
                                </usau:BackupSlot.BackupValues>
                              </usau:BackupSlot>
                            </uga:SendEmailConnections.InputTypeBackup>
                          </uga:SendEmailConnections>
                        </TryCatch.Try>
                        <TryCatch.Catches>
                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,22" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ActivityAction x:TypeArguments="s:Exception">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                              </ActivityAction.Argument>
                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,141" sap2010:WorkflowViewState.IdRef="LogMessage_3" Message="[&quot;wrong email &quot;+recipientEmail]" />
                            </ActivityAction>
                          </Catch>
                        </TryCatch.Catches>
                      </TryCatch>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="438,173" sap2010:WorkflowViewState.IdRef="LogMessage_4" Message="[&quot;email sent &quot;+ recipientEmail]" />
                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{recipientEmail, DateTime.UtcNow.ToString(&quot;yyyy-MM-dd HH:mm:ss&quot;)}]" DataTable="[dtSentEmails]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="438,218" sap2010:WorkflowViewState.IdRef="AddDataRow_3" />
                      <ui:WriteRange StartingCell="{x:Null}" WorkbookPathResource="{x:Null}" DataTable="[dtSentEmails]" DisplayName="Write Range Workbook" sap:VirtualizedContainerService.HintSize="438,139" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="Sheet1" WorkbookPath="PassportExpSentEmails.xlsx" />
                    </Sequence>
                  </If.Else>
                </If>
              </Sequence>
            </ActivityAction>
          </ui:ForEach.Body>
        </ui:ForEach>
      </Sequence>
    </Sequence>
  </Sequence>
</Activity>